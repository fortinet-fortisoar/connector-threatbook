{
  "name": "threatbook",
  "label": "ThreatBook",
  "description": "ThreatBook is Chinaâ€™s first security threat intelligence company, dedicated to providing real-time, accurate and actionable threat intelligence to block, detect and prevent attacks.",
  "publisher": "Community",
  "cs_approved": false,
  "cs_compatible": true,
  "version": "1.0.0",
  "category": "Threat Intelligence",
  "help_online": "https://docs.fortinet.com/document/fortisoar/1.0.0/threatbook/336/threatbook-v1-0-0",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "name": "server_url",
        "type": "text",
        "description": "Specify the ThreatBook server URL for this connector to connect and perform automated operations.",
        "required": true,
        "editable": true,
        "visible": true,
        "value": "https://api.threatbook.cn"
      },
      {
        "title": "API Key",
        "name": "api_key",
        "type": "password",
        "description": "Specify an API Key for this connector to access the ThreatBook endpoint.",
        "required": true,
        "editable": true,
        "visible": true
      },
      {
        "title": "Verify SSL",
        "name": "verify_ssl",
        "type": "checkbox",
        "description": "Select the checkbox to verify the server's SSL certificate. By default, this option is set as True.",
        "required": false,
        "editable": true,
        "visible": true,
        "value": true
      }
    ]
  },
  "operations": [
    {
      "operation": "submit_ip",
      "title": "Submit IP for Analysis",
      "category": "investigation",
      "annotation": "submit_ip",
      "description": "Retrives information about an IP address' geographical location, ASN information, related attack groups, security incidents tags, raw intelligence, and other relevant information. Specify an IP address to obtain business logs and external IP addresses from security devices such as firewalls and Web Application Firewalls (WAF). It helps comprehensively determine threat types such as Remote Control (C2), Zombie, Compromised, Scanner, and Phishing.",
      "parameters": [
        {
          "title": "IP Address",
          "name": "resource",
          "type": "text",
          "description": "Specify the IP address to be submitted to ThreatBook for analysis.",
          "tooltip": "Specify the IP address to be submitted to ThreatBook for analysis.",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Exclude",
          "name": "exclude",
          "type": "multiselect",
          "description": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. asn: asn information. ports: Port information. cas: SSL certificate and other information. rdns_list: rdns record information. intelligences: threat intelligence. judgments: The types of threats that are analyzed and comprehensively determined from threat intelligence. tags_classes: related attack groups or security event information tags, etc. samples: relevant samples. update_time: The last update time of the intelligence. sum_cur_domains: The number of domains currently pointing to. scene: application scene.",
          "tooltip": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. asn: asn information. ports: Port information. cas: SSL certificate and other information. rdns_list: rdns record information. intelligences: threat intelligence. judgments: The types of threats that are analyzed and comprehensively determined from threat intelligence. tags_classes: related attack groups or security event information tags, etc. samples: relevant samples. update_time: The last update time of the intelligence. sum_cur_domains: The number of domains currently pointing to. scene: application scene.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "asn",
            "ports",
            "cas",
            "rdns_list",
            "intelligences",
            "judgments",
            "tags_classes",
            "samples",
            "update_time",
            "sum_cur_domains",
            "scene"
          ]
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not specified, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "tooltip": "Select the language in which the result appears. When this parameter is not specified, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "api_output_schema": "get_ip_analysis_schema",
      "output_schema": {
        "data": {
          "": {
            "samples": [],
            "tags_classes": [],
            "judgments": [],
            "intelligences": {
              "threatbook_lab": [
                {
                  "source": "",
                  "confidence": "",
                  "expired": "",
                  "intel_tags": [],
                  "find_time": "",
                  "intel_types": [],
                  "update_time": ""
                },
                {
                  "source": "",
                  "confidence": "",
                  "expired": "",
                  "intel_tags": [],
                  "find_time": "",
                  "intel_types": [],
                  "update_time": ""
                }
              ],
              "x_reward": [],
              "open_source": []
            },
            "scene": "",
            "basic": {
              "carrier": "",
              "location": {
                "country": "",
                "province": "",
                "city": "",
                "lng": "",
                "lat": "",
                "country_code": ""
              }
            },
            "asn": {
              "rank": "",
              "info": "",
              "number": ""
            },
            "ports": [],
            "cas": [],
            "update_time": "",
            "rdns_list": [],
            "sum_cur_domains": ""
          }
        },
        "response_code": "",
        "verbose_msg": ""
      }
    },
    {
      "operation": "get_ip_reputation",
      "title": "Get IP Reputation",
      "category": "investigation",
      "annotation": "get_ip_reputation",
      "description": "Retrives information about an IP address' geographical location, ASN information, its risk severity level, and its credibility level through judgement rules. Specify an IP address to accurately determine if it is malicious and get its reputation.",
      "parameters": [
        {
          "title": "IP Address",
          "name": "resource",
          "type": "text",
          "description": "Specify a comma-separated list of the IP addresses to get the reputation. It supports a batch query for up to 100 values separated by commas.",
          "tooltip": "Specify a comma-separated list of the IP addresses to get the reputation. It supports a batch query for up to 100 values separated by commas.",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "tooltip": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "output_schema": {
        "data": {
          "": {
            "severity": "",
            "judgments": [],
            "tags_classes": [],
            "basic": {
              "carrier": "",
              "location": {
                "country": "",
                "province": "",
                "city": "",
                "lng": "",
                "lat": "",
                "country_code": ""
              }
            },
            "asn": {
              "rank": "",
              "info": "",
              "number": ""
            },
            "scene": "",
            "confidence_level": "",
            "is_malicious": "",
            "update_time": ""
          }
        },
        "response_code": "",
        "verbose_msg": ""
      }
    },
    {
      "operation": "domain_analysis",
      "title": "Submit Domain for Analysis",
      "category": "investigation",
      "annotation": "domain_analysis",
      "description": "Retrives a domain name's IP address and its current WhoIs information to comprehensively determine the threat. Specify a domain name to pull relevant information from an internal DNS or Next-Generation Firewalls.",
      "parameters": [
        {
          "title": "Domain Name",
          "name": "resource",
          "type": "text",
          "description": "Specify a domain name to analyze",
          "tooltip": "Provide a domain name to analysis",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Exclude",
          "name": "exclude",
          "type": "multiselect",
          "description": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. cur_ips: The resolution IP address information of the domain name cur_whois: The current whois information of the domain name cas: SSL certificate and other information intelligences: threat intelligence judgments: The types of threats that are analyzed and comprehensively determined from threat intelligence tags_classes: related attack groups or security event information tags, etc. samples: relevant samples categories: Domain name categories",
          "tooltip": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. cur_ips: The resolution IP address information of the domain name cur_whois: The current whois information of the domain name cas: SSL certificate and other information intelligences: threat intelligence judgments: The types of threats that are analyzed and comprehensively determined from threat intelligence tags_classes: related attack groups or security event information tags, etc. samples: relevant samples categories: Domain name categories",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "cur_ips",
            "cur_whois",
            "cas",
            "intelligences",
            "judgments",
            "tags_classes",
            "samples",
            "categories"
          ]
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "tooltip": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "api_output_schema": "get_domain_analysis_schema",
      "output_schema": {
        "": {
          "judgments": [],
          "rank": {
            "alexa_rank": {
              "global_rank": ""
            },
            "umbrella_rank": {
              "global_rank": ""
            }
          },
          "intelligences": {
            "threatbook_lab": [
              {
                "find_time": "",
                "expired": "",
                "confidence": "",
                "source": "",
                "intel_types": [],
                "intel_tags": [
                  {
                    "tags_type": "",
                    "tags": []
                  },
                  {
                    "tags_type": "",
                    "tags": []
                  }
                ]
              }
            ],
            "x_reward": [
              {
                "find_time": "",
                "expired": "",
                "confidence": "",
                "source": "",
                "intel_types": [],
                "intel_tags": [
                  {
                    "tags_type": "",
                    "tags": []
                  },
                  {
                    "tags_type": "",
                    "tags": []
                  }
                ]
              }
            ],
            "open_source": [
              {
                "find_time": "",
                "expired": "",
                "confidence": "",
                "source": "",
                "intel_types": [],
                "intel_tags": [
                  {
                    "tags_type": "",
                    "tags": []
                  },
                  {
                    "tags_type": "",
                    "tags": []
                  }
                ]
              }
            ]
          },
          "tags_classes": [
            {
              "tags_type": "",
              "tags": []
            },
            {
              "tags_type": "",
              "tags": []
            }
          ],
          "samples": [
            {
              "sha256": "",
              "scan_time": "",
              "malware_type": "",
              "ratio": "",
              "malware_family": ""
            }
          ],
          "cur_ips": [
            {
              "ip": "",
              "carrier": "",
              "location": {
                "country": "",
                "country_code": "",
                "province": "",
                "lng": "",
                "city": "",
                "lat": ""
              }
            },
            {
              "ip": "",
              "carrier": "",
              "location": {
                "country": "",
                "country_code": "",
                "province": "",
                "lng": "",
                "city": "",
                "lat": ""
              }
            }
          ],
          "cur_whois": {
            "registrant_phone": "",
            "name_server": "",
            "cdate": "",
            "registrant_address": "",
            "registrar_name": "",
            "registrant_name": "",
            "alexa": "",
            "registrant_email": "",
            "registrant_company": "",
            "udate": "",
            "edate": ""
          },
          "categories": {
            "first_cats": [],
            "second_cats": ""
          },
          "cas": [
            {
              "subject": "",
              "issuer": "",
              "fingerprint": "",
              "purpose": "",
              "verify": "",
              "status": "",
              "revoked": "",
              "begin": "",
              "end": "",
              "status_desc": "",
              "serial_number": "",
              "revoked_time": ""
            }
          ]
        }
      }
    },
    {
      "operation": "loss_detection",
      "title": "Get Loss Detection Data",
      "category": "investigation",
      "annotation": "loss_detection",
      "description": "Retrieves information from external access scenarios such as office network or production network about an IP address or a domain name's risk severity level and its credibility level through judgment rules. Specify an IP address or a domain name to accurately determine if the IP or the domain name is malicious, identify their threat types such as remote control (C2), malware (Malware), and mining pool threats, and to get relevant security incidents or group labels.",
      "parameters": [
        {
          "title": "Resource",
          "name": "resource",
          "type": "text",
          "description": "Specify IP addresses or domain names, support batch query, up to 100, separated by commas. IP adress can be queried with ports to obtain high-confidence judgment results. Following is an example of IP addresses, with port format, in the request: 8.8.8.8:143,0.0.0.0:80",
          "tooltip": "Specify IP addresses or domain names, support batch query, up to 100, separated by commas. IP adress can be queried with ports to obtain high-confidence judgment results. Following is an example of IP addresses, with port format, in the request: 8.8.8.8:143,0.0.0.0:80",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English.",
          "tooltip": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "output_schema": {
        "response_code": "",
        "verbose_msg": "",
        "data": {
          "ips": {},
          "domains": {}
        }
      }
    },
    {
      "operation": "submit_file",
      "title": "Submit File",
      "category": "investigation",
      "annotation": "submit_file",
      "description": "Detects malicious files such as in office terminals, Web, FTP, email attachments, and suspicious files on terminals/servers using 22 anti-virus scanning engines. Specify a file IRI or an attachment ID and according to different file types, the system automatically selects an appropriate sandbox environment for dynamic detection.",
      "parameters": [
        {
          "name": "input",
          "title": "Type",
          "type": "select",
          "options": [
            "Attachment ID",
            "File IRI"
          ],
          "editable": true,
          "visible": true,
          "required": true,
          "description": "Specify the type of file to submit to ThreatBook for analysis. Type can be an Attachment ID or a File IRI.",
          "value": "File IRI"
        },
        {
          "name": "value",
          "title": "Reference ID",
          "type": "text",
          "editable": true,
          "visible": true,
          "required": true,
          "description": "Specify a Reference ID to access the attachment metadata from the FortiSOAR Attachments module. In the playbook, this defaults to the {{vars.attachment_id}}value or the {{vars.file_iri}}value."
        },
        {
          "title": "Sandbox Type",
          "name": "sandbox_type",
          "type": "select",
          "description": "Specify a sandbox running environment for the submitted file.",
          "tooltip": "Specify a sandbox running environment for the submitted file.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "win7_sp1_enx64_office2013",
            "win7_sp1_enx86_office2013",
            "win7_sp1_enx86_office2010",
            "win7_sp1_enx86_office2007",
            "win7_sp1_enx86_office2003",
            "ubuntu_1704_x64",
            "centos_7_x64"
          ]
        },
        {
          "title": "Run Time",
          "name": "run_time",
          "type": "integer",
          "description": "Specify a sandbox running time controlled within 300s according to demand. By default the value is 60s",
          "tooltip": "Specify a sandbox running time controlled within 300s according to demand. By default the value is 60s",
          "required": false,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true,
      "output_schema": {
        "verbose_msg": "",
        "response_code": "",
        "data": {
          "sha256": "",
          "permalink": ""
        }
      }
    },
    {
      "operation": "get_file_reputation",
      "title": "Get File Reputation",
      "category": "investigation",
      "annotation": "get_file_reputation",
      "description": "Retrieves detailed static and dynamic analysis reports of files, including file summary information, network behavior, behavior signature, static information, release behavior, process behavior, and anti-virus scan engine detection results. Specify a file hash to get a file's reputation and other relevant information.",
      "parameters": [
        {
          "title": "Hash Type",
          "name": "hash_type",
          "type": "select",
          "description": "Select type of file hash to get the analysis report.",
          "tooltip": "Select type of file hash to get the analysis report.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "SHA256",
            "SHA1",
            "MD5"
          ],
          "value": "SHA256"
        },
        {
          "title": "Hash Value",
          "name": "hash_value",
          "type": "text",
          "description": "Specify a hash value of the selected hash type of the file, to get the analysis report.",
          "tooltip": "Specify a hash value of the selected hash type of the file, to get the analysis report.",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Sandbox Type",
          "name": "sandbox_type",
          "type": "select",
          "description": "Specify a sandbox running environment to open the submitted file.",
          "tooltip": "Specify a sandbox running environment to open the submitted file.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "win7_sp1_enx64_office2013",
            "win7_sp1_enx86_office2013",
            "win7_sp1_enx86_office2010",
            "win7_sp1_enx86_office2007",
            "win7_sp1_enx86_office2003",
            "ubuntu_1704_x64",
            "centos_7_x64"
          ]
        },
        {
          "title": "Query Fields",
          "name": "query_fields",
          "type": "select",
          "description": "File analysis report contains all the fields, by default. Optionally, select one of the following fields for file analysis report to contain only that field: Summary Network Signature Static Dropped PSTree Multiengines",
          "tooltip": "File analysis report contains all the fields, by default. Optionally, select one of the following fields for file analysis report to contain only that field: Summary Network Signature Static Dropped PSTree Multiengines",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "Summary",
            "Network",
            "Signature",
            "Static",
            "Dropped",
            "pstree",
            "Multiengines"
          ]
        }
      ],
      "enabled": true,
      "output_schema": {
        "response_code": "",
        "data": {
          "summary": {
            "threat_level": "",
            "is_whitelist": "",
            "submit_time": "",
            "file_name": "",
            "file_type": "",
            "sample_sha256": "",
            "tag": {
              "s": [],
              "x": []
            },
            "threat_score": "",
            "sandbox_type": "",
            "sandbox_type_list": [],
            "multi_engines": ""
          },
          "multiengines": {
            "result": {
              "Kaspersky": "",
              "Microsoft": ""
            },
            "scan_time": ""
          },
          "static": {
            "details": {
              "pe_version_info": [],
              "pe_sections": [],
              "pe_signatures": {},
              "pe_imports": [],
              "pe_resources": [],
              "tag": [],
              "pe_detect": {},
              "pe_basic": {},
              "pe_exports": []
            },
            "basic": {
              "sha1": "",
              "sha256": "",
              "file_type": "",
              "file_name": "",
              "ssdeep": "",
              "file_size": "",
              "md5": ""
            }
          },
          "signature": [
            {
              "severity": "",
              "references": [],
              "sig_class": "",
              "name": "",
              "description": "",
              "markcount": "",
              "marks": [],
              "families": [],
              "attck_id": "",
              "attck_info": {}
            }
          ],
          "dropped": [
            {
              "sha1": "",
              "urls": [],
              "sha256": "",
              "size": "",
              "filepath": "",
              "name": "",
              "crc32": "",
              "ssdeep": "",
              "type": "",
              "yara": [],
              "md5": ""
            }
          ],
          "pstree": {
            "children": [
              {
                "track": "",
                "pid": "",
                "process_name": "",
                "command_line": "",
                "first_seen": "",
                "ppid": "",
                "children": []
              }
            ],
            "process_name": {
              "en": "",
              "cn": ""
            }
          },
          "network": {
            "fingerprint": [],
            "tls": [],
            "udp": [],
            "dns_servers": [],
            "http": [],
            "irc": [],
            "smtp": [],
            "tcp": [],
            "smtp_ex": [],
            "mitm": [],
            "hosts": [],
            "dns": [],
            "http_ex": [],
            "domains": [],
            "dead_hosts": [],
            "icmp": [],
            "https_ex": []
          }
        },
        "verbose_msg": ""
      }
    },
    {
      "operation": "file_detection_report",
      "title": "Get File Detection Report",
      "category": "investigation",
      "annotation": "file_detection_report",
      "description": "Retrieves a file detection report from the results of files that have been detected by the many anti-virus scanning engines in ThreatBook. Specify a file hash value to get the analysis report.",
      "parameters": [
        {
          "title": "Hash Type",
          "name": "hash_type",
          "type": "select",
          "description": "Select type of file hash, used to get the analysis report.",
          "tooltip": "Select type of file hash, used to get the analysis report.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "SHA256",
            "SHA1",
            "MD5"
          ],
          "value": "SHA256"
        },
        {
          "title": "Hash Value",
          "name": "hash_value",
          "type": "text",
          "description": "Specify a hash value of the selected hash type of the file, to get the analysis report.",
          "tooltip": "Specify a hash value of the selected hash type of the file, to get the analysis report.",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true,
      "output_schema": {
        "response_code": "",
        "data": {
          "multiengines": {
            "threat_level": "",
            "total": "",
            "scans": {
              "vbwebshell": "",
              "Avast": "",
              "Rising": "",
              "K7": "",
              "Kaspersky": "",
              "NANO": "",
              "Baidu-China": "",
              "Microsoft": "",
              "ClamAV": "",
              "IKARUS": "",
              "Huorong": "",
              "Avira": "",
              "Sophos": "",
              "Panda": "",
              "Antiy": "",
              "AVG": "",
              "Baidu": "",
              "DrWeb": "",
              "GDATA": "",
              "Qihu360": "",
              "ESET": "",
              "JiangMin": ""
            },
            "is_white": "",
            "total2": "",
            "positives": "",
            "scan_date": "",
            "malware_type": "",
            "malware_family": ""
          }
        },
        "verbose_msg": ""
      }
    },
    {
      "operation": "scan_url",
      "title": "Submit URL for Scanning",
      "category": "investigation",
      "annotation": "scan_url",
      "description": "Retrieves a URL scanning analysis report by submitting a URL for scanning to the 11 URL scanning engines and URL/domain name blacklist services. Specify a URL to analyze the files downloaded by the URL and generate a URL scanning analysis report.",
      "parameters": [
        {
          "title": "URL",
          "name": "url",
          "type": "text",
          "description": "Specify a URL for analysis.",
          "tooltip": "Specify a URL for analysis.",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true,
      "output_schema": {
        "response_code": "",
        "verbose_msg": "",
        "data": {
          "url": "",
          "time": "",
          "permalink": ""
        }
      }
    },
    {
      "operation": "get_url_reputations",
      "title": "Get URL Reputations",
      "category": "investigation",
      "annotation": "get_url_reputations",
      "description": "Retrieves a URL's reputation from the analysis results of downloaded files. Specify a URL to get URL scan engine detection results.",
      "parameters": [
        {
          "title": "URL",
          "name": "url",
          "type": "text",
          "description": "Specify a URL to get URL scan engine's detection result.",
          "tooltip": "Specify a URL to get URL scan engine's detection result.",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true,
      "output_schema": {
        "response_code": "",
        "data": {
          "multiengines": {
            "threatbook": "",
            "Google Safebrowsing": ""
          },
          "threat_level": "",
          "sandbox": {
            "threat_level": "",
            "submit_time": "",
            "file_name": "",
            "file_type": "",
            "sample_sha256": "",
            "tag": [],
            "sb_status": "",
            "sandbox_type": "",
            "sandbox_type_list": []
          },
          "details": {
            "headers": {
              "Accept-Ranges": "",
              "Strict-Transport-Security": "",
              "Server": "",
              "ETag": "",
              "Connection": "",
              "Last-Modified": "",
              "Content-Length": "",
              "Date": "",
              "Content-Type": ""
            },
            "lastSeen": "",
            "ip": "",
            "historyScans": [
              {
                "fileName": "",
                "sha256": "",
                "multiEngines": "",
                "fileType": ""
              }
            ],
            "finalUrl": "",
            "url": "",
            "sha256s": [],
            "status": "",
            "httpStatusCode": ""
          }
        },
        "verbose_msg": ""
      }
    },
    {
      "operation": "run_ip_advance_query",
      "title": "Run IP Advance Query",
      "category": "investigation",
      "annotation": "run_ip_advance_query",
      "description": "Retrieves an IP address' current domain name and historical domain name information. Specify an IP address, and optionally, select exclusion parameters to filter the returned results and analyze only the relevant information.",
      "parameters": [
        {
          "title": "IP Address",
          "name": "resource",
          "type": "text",
          "description": "Specify an IP address to obtain domain related information",
          "tooltip": "Specify an IP address to obtain domain related information",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Exclude",
          "name": "exclude",
          "type": "multiselect",
          "description": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. asn: asn information. cur_domains: The domain names currently pointing to this IP. history_domains: IP reverse history domain names.",
          "tooltip": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. asn: asn information. cur_domains: The domain names currently pointing to this IP. history_domains: IP reverse history domain names.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "asn",
            "cur_domains",
            "history_domains"
          ]
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "tooltip": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "output_schema": {
        "data": {
          "ip": "",
          "basic": {},
          "asn": {
            "rank": "",
            "info": "",
            "number": ""
          },
          "cur_domains": [],
          "history_domains": {
            "2017-02-22": [],
            "2017-01-29": [],
            "2016-12-21": [],
            "2016-09-11": [],
            "2015-12-17": []
          }
        },
        "response_code": "",
        "verbose_msg": ""
      }
    },
    {
      "operation": "run_domain_advance_query",
      "title": "Run Domain Advanced Query",
      "category": "investigation",
      "annotation": "run_domain_advance_query",
      "description": "Retrieves a domain name's historical Whois information and its historical IP address resolution information. Specify a domain name, and optionally, select exclusion parameters to run an advanced domain name query, filter the returned results, and analyze only the relevant information.",
      "parameters": [
        {
          "title": "Domain Name",
          "name": "resource",
          "type": "text",
          "description": "Specify a domain name to obtain domain related information",
          "tooltip": "Specify a domain name to obtain domain related information",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Exclude",
          "name": "exclude",
          "type": "select",
          "description": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. history_ips: Domain name historical resolution IP information. history_whoises: domain name history whois information.",
          "tooltip": "Exclude any of the following parameters according to the actual usage scenario, and the result information is returned. Multiple parameters should be separated by commas and must not contain spaces. history_ips: Domain name historical resolution IP information. history_whoises: domain name history whois information.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "history_ips",
            "history_whoises"
          ]
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "tooltip": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "output_schema": {
        "data": {
          "domain": "",
          "history_whoises": [
            {
              "date": "",
              "whois": {
                "cdate": "",
                "edate": "",
                "udate": "",
                "alexa": "",
                "registrar_name": "",
                "name_server": "",
                "registrant_name": "",
                "registrant_email": "",
                "registrant_company": "",
                "registrant_address": "",
                "registrant_phone": ""
              }
            }
          ],
          "history_ips": [
            {
              "date": "",
              "ips": [
                {
                  "ip": ""
                }
              ]
            }
          ]
        },
        "response_code": "",
        "verbose_msg": ""
      }
    },
    {
      "operation": "run_sub_domain_query",
      "title": "Run Sub Domain Query",
      "category": "investigation",
      "annotation": "run_sub_domain_query",
      "description": "Retrieves a domain name's subdomain information. Specify a domain name to run an advanced domain name query.",
      "parameters": [
        {
          "title": "Domain Name",
          "name": "resource",
          "type": "text",
          "description": "Specify a domain name to obtain sub domain information",
          "tooltip": "Specify a domain name to obtain sub domain information",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "tooltip": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English.",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "output_schema": {
        "data": {
          "domain": "",
          "sub_domains": {
            "total": "",
            "data": []
          }
        },
        "response_code": "",
        "verbose_msg": ""
      }
    },
    {
      "operation": "get_domain_name_context",
      "title": "Get Domain Name Context",
      "category": "investigation",
      "annotation": "get_domain_name_context",
      "description": "Retrieves evidence and disposal advice regarding malicious domain names. Specify a domain name to query the context information about domains that have been identified in a breach.",
      "parameters": [
        {
          "title": "Domain Name",
          "name": "resource",
          "type": "text",
          "description": "Specify a domain name to obtain the context information",
          "tooltip": "Specify a domain name to obtain the context information",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Language",
          "name": "lang",
          "type": "select",
          "description": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "tooltip": "Select the language in which the result appears. When this parameter is not entered, the results are returned in English, by default. The available options are: zh: All returned results are displayed in Chinese en: All returned results are displayed in English",
          "required": false,
          "editable": true,
          "visible": true,
          "options": [
            "zh",
            "en"
          ]
        }
      ],
      "enabled": true,
      "api_output_schema": "get_domain_name_context_schema",
      "output_schema": {
        "data": {
          "": {
            "context": [
              {
                "sample": "",
                "source_urls": []
              },
              {
                "sample": "",
                "source_urls": [
                  {
                    "ip": "",
                    "url": ""
                  }
                ]
              }
            ],
            "forensics": [
              {
                "sample": {
                  "sha256": "",
                  "tag": {
                    "s": [],
                    "x": []
                  },
                  "domains": [
                    {
                      "domain": "",
                      "ip": ""
                    }
                  ],
                  "file_type": "",
                  "malware_family": "",
                  "malware_type": "",
                  "threat_level": ""
                },
                "suggestion": {}
              }
            ]
          }
        },
        "response_code": "",
        "verbose_msg": ""
      }
    }
  ]
}
